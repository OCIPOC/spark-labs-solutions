<h1 id="pair-rdd-solution">Pair RDD Solution</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">val</span> data = sc.<span class="fu">textFile</span>(<span class="st">&quot;/data/people.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">data.<span class="fu">foreach</span>(println)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">val</span> people = data.<span class="fu">map</span>(line =&gt; {</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                    <span class="kw">val</span> tokens = line.<span class="fu">split</span>(<span class="st">&quot;,&quot;</span>) <span class="co">// split the line</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">                    <span class="kw">val</span> name = <span class="fu">tokens</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">                    <span class="kw">val</span> gender = <span class="fu">tokens</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">                    <span class="kw">val</span> age = <span class="fu">tokens</span>(<span class="dv">2</span>).<span class="fu">toInt</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">                    (name, gender, age) <span class="co">// create a KV pair (name, gender)</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">                    })</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">people.<span class="fu">foreach</span>(println)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">val</span> males = people.<span class="fu">filter</span> {<span class="kw">case</span> (name, gender, age) =&gt; gender == <span class="st">&quot;M&quot;</span>}</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">males.<span class="fu">collect</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">males.<span class="fu">foreach</span>(println)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">val</span> teens = people.<span class="fu">filter</span> {<span class="kw">case</span> (name, gender, age) =&gt; (age &gt;= <span class="dv">13</span>) &amp;&amp; (age &lt;= <span class="dv">19</span>)}</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">teens.<span class="fu">foreach</span>(println)</a></code></pre></div>
